import osmnx as oximport networkx as nximport randomimport matplotlib.pyplot as pltfrom shapely.geometry import Pointfrom simulation import estimate_timefrom config import CAR_BASE_SPEED, BIKE_BASE_SPEEDdef count_lights_on_route(G, route, lights_gdf, dist=20):    count = 0    for node in route:        x = G.nodes[node]["x"]        y = G.nodes[node]["y"]        p = Point(x, y)        # odległość w METRACH (bo CRS jest projektowany)        nearby = lights_gdf.distance(p) < dist        if nearby.any():            count += 1    return int(count/2)def main():    print("Pobieranie mapy Wrocławia...")    ox.settings.use_cache = True    # graf + rzutowanie do CRS metrycznego    G = ox.graph_from_place("Poland, Wrocław", network_type="drive", simplify=True)    G = ox.project_graph(G)    # światła i rzutowanie do tego samego CRS co graf    lights = ox.features_from_place(        "Wrocław, Poland",        tags={"highway": "traffic_signals"}    )    lights = lights.to_crs(G.graph["crs"])    nodes = list(G.nodes)    start = random.choice(nodes)    end = random.choice(nodes)    print("Start:", start)    print("Cel:", end)    route = nx.shortest_path(G, start, end, weight="length")    route_length = nx.shortest_path_length(G, start, end, weight="length")    print("Odległość [m]:", route_length)    # liczba świateł na trasie (w promieniu 20 m)    n_lights = count_lights_on_route(G, route, lights, dist=20)    print("Liczba świateł na trasie:", n_lights)    car_time = estimate_time(G, route, CAR_BASE_SPEED, "car", n_lights)    bike_time = estimate_time(G, route, BIKE_BASE_SPEED, "bike", n_lights)    print("Auto:", round(car_time, 1), "s =", round(car_time / 60, 2), "min")    print("Rower:", round(bike_time, 1), "s =", round(bike_time / 60, 2), "min")    # rysowanie    fig, ax = ox.plot_graph(G, show=False, close=False)    ox.plot_graph_route(G, route, ax=ax, route_color="red",                        route_linewidth=3, show=False, close=False)    # start / end    ax.scatter(G.nodes[start]["x"], G.nodes[start]["y"], c="green", s=80)    ax.scatter(G.nodes[end]["x"], G.nodes[end]["y"], c="blue", s=80)    # wszystkie światła    ax.scatter(lights.geometry.x, lights.geometry.y, c="yellow", s=20)    plt.show()if __name__ == "__main__":    main()